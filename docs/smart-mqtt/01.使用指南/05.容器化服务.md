---
title: 容器化服务
date: 2022-11-12 15:28:13
permalink: /smart-mqtt/docker.html
---

如果你手头正好有一套 Docker 环境，那会是一件非常美好的事。因为，你只需要通过一两个操作指令，便能搭建出 smart-mqtt broker 服务。

> 镜像地址：[https://hub.docker.com/r/smartboot/smart-mqtt](https://hub.docker.com/r/smartboot/smart-mqtt)

下面提供两种方式用于启动 smart-mqtt 的 docker 容器：

## 方式一：docker run
```shell
docker run -d --name smart-mqtt -p 1883:1883 smartboot/smart-mqtt:latest
```
搞定！！！没错，就是这么简单。

当然，你也可以执行`docker ps`确认下服务是否正常启动。

如果失败了，建议检查下宿主机的端口是否已被占用。

## 方式二：docker compose(推荐)
虽然方式一只需一行命令就完成 smart-mqtt 的启动，但个人更推荐使用`docker compose`。具体步骤如下：
1. 找一个你认为风水比较好的目录，新建文件：`docker-compose.yml`，复制粘贴以下内容并保存。
    ```yaml
    services:
      smart-mqtt:
        container_name: smart-mqtt
        hostname: smart-mqtt
        image: smartboot/smart-mqtt:latest
        ports:
          - 1883:1883/tcp
        read_only: true
        restart: always
        security_opt:
          - no-new-privileges:true
        user: root:root
        logging:
          driver: "json-file"
          options:
            max-size: "100m"
            max-file: "1"
    version: '3.7'
    ```
2. 在`docker-compose.yml`文件所在目录下执行命令：`docker compose up -d`（有些环境或许是`docker-compose up -d`）。如果一切顺利的话，稍等片刻 smart-mqtt 便会完成启动。  
    假如需要停止服务，只需执行`docker compose stop`。  
    若要移除容器，可以执行`docker compose down`。  
    这些操作形式比 `docker stop` 、`docker rm` 方便很多，这也是推荐使用 `docker compose` 管理服务的主要原因。  