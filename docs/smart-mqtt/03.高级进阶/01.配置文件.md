---
title: 配置文件
date: 2022-12-09 17:37:22
permalink: /smart-mqtt/configure.html
---
smart-mqtt 配置文件采用的 yaml 格式，其配置结构分为两大块：Broker基础配置、插件配置。
```yaml
# Broker基础配置
broker:
  key_1: value
  key_2: value
  
# 插件配置  
plugins:
  - plugin-A:
      key_1: value
      key_2: value
  - plugin-B:
      key_4: value
      key_5: value
```
## Broker基础配置
### port
Broker 服务端口号，默认：**1883**
### host
Broker 服务绑定的本地 IP 地址，若为空则所有 IP 可用。

### threadNum
Broker 的服务线程数，默认等同于当前服务器的 CPU 核数。

### pushThreadNum
消息推送服务的线程数，默认等同于当前服务器的 CPU 核数。

### bufferSize
IO缓冲区大小，默认：**4096**。 

合理的大小设置会带来更好的通信性能，具体参考《[缓冲区调优](/smart-mqtt/buffer-optimize.html)》。

### maxPacketSize
限制单个MQTT消息包的最大字节数，默认：**1048576**（1MB）

如果实际场景中的消息大小超过该默认值，可适当调大。

### topicLimit
Broker支持的Topic数量上限，默认：1024.

### maxKeepAliveTime
客户端支持的最长`keep-alive`时长。

当发送的`Connect`中夹带的keepAlive时长超过改值时，将以`maxKeepAliveTime`为准。

### noConnectIdleTimeout
网络连接建立后，如果服务端在合理的时间内没有收到 CONNECT 报文，服务端应该关闭这个连接。

单位：**毫秒**，默认：**5000**。
### maxInflight
在完成应答前，同时投递的 QoS 1 和 QoS 2 消息的最大数量。

### 完整示例
```yaml
broker:
  port: 1883
  host: 0.0.0.0
  threadNum: 16
  maxInflight: 8
  maxPacketSize: 4096
  noConnectIdleTimeout: 5000
```

## 开源插件配置
暂无