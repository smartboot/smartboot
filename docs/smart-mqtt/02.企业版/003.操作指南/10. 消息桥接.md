---
title:  消息桥接
date: 2022-12-03 13:25:12
permalink: /smart-mqtt/bridge.html
---

桥接是用来对接 MQTT Broker 和外部数据系统的通道。
外部数据系统可以是 MySQL、MongoDB、InfluxDB 等数据库， 也可以是 Kafka，RocketMQ 等消息中间件，或者是 HTTP 服务器等。

通过桥接技术，用户可以实时地将消息从 MQTT Broker 发送到外部数据系统，或者从外部数据系统拉取数据并发送到 Broker 的某个主题。

![](../img/bridge.svg)


## redis-bridge
### 1. 启动 Redis 服务
为了便于演示，我们采用 docker 快速搭建出一套 redis 环境，并设置了连接认证密码为：`smart-mqtt`。
```shell
docker run --name redis -p 6379:6379 -d redis --requirepass "smart-mqtt"
```

### 2. 配置Redis插件

```yaml
plugins:
  - redis-bridge:
      enable: true
      host: 127.0.0.1
      port: 6379
      password: smart-mqtt
      timeout:
      base64: false
```
## mqtt-bridge
mqtt-bridge 用于将当前 Broker 收到的消息转发到其他 MQTT Broker。
### 1. 参数配置

```yaml
plugins:
  - mqtt-bridge:
      clientId: 
      username:
      password:
      bridges:
        - host: 127.0.0.1
          port: 8081
          username:
          password:
          clientId:
        - host: 127.0.0.1
          port: 1884
          username:
          password:
          clientId:
```