(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{394:function(t,a,_){"use strict";_.r(a);var s=_(7),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"一、持久化方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、持久化方式"}},[t._v("#")]),t._v(" 一、持久化方式")]),t._v(" "),a("p",[t._v("smart-mqtt 企业版将提供相对自由的数据持久化选型。目前已经适配了：H2 和 MySQL 两种数据库，其中 H2 数据库又分为"),a("strong",[t._v("内存模式")]),t._v("和"),a("strong",[t._v("文件模式")]),t._v("。")]),t._v(" "),a("p",[t._v("选择不同的持久化策略，会有着不同的服务效果：")]),t._v(" "),a("ul",[a("li",[t._v("h2_mem"),a("br"),t._v("\nH2数据库的内存模式，重启服务将会丢失数据，通常用于"),a("strong",[t._v("企业版的演示环境")]),t._v("。")]),t._v(" "),a("li",[t._v("h2"),a("br"),t._v("\nH2 数据库的文件模式，会在运行包的同目录下生成"),a("code",[t._v("smart-mqtt.mv.db")]),t._v("文件，选择该模式会在重启Broker服务时会保留历史数据。"),a("br"),t._v("\n该模式的优点在于无外部依赖，开箱即用。单缺点是多个Broker服务无法共享同一个 H2 数据库文件，不适用Broker集群环境。")]),t._v(" "),a("li",[t._v("mysql"),a("br"),t._v("\n可靠性相对较高的持久化模式。多 Broker 连接同一数据库可方便组织成集群，各节点信息、数据交互便利。"),a("br"),t._v("\n缺点在于需要额外维护 MySQL 服务，好在目前此类数据库通常由云厂商托管了，也算省心省力。")])]),t._v(" "),a("h2",{attrs:{id:"二、持久化内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、持久化内容"}},[t._v("#")]),t._v(" 二、持久化内容")]),t._v(" "),a("h3",{attrs:{id:"_2-1-mqtt-broker-节点配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-mqtt-broker-节点配置"}},[t._v("#")]),t._v(" 2.1 MQTT Broker 节点配置")]),t._v(" "),a("ul",[a("li",[t._v("节点名称")]),t._v(" "),a("li",[t._v("版本号")]),t._v(" "),a("li",[t._v("运行服务器IP")]),t._v(" "),a("li",[t._v("进程号")]),t._v(" "),a("li",[t._v("最近一次内存使用率")]),t._v(" "),a("li",[t._v("最近一次CPU使用率")]),t._v(" "),a("li",[t._v("最近一次启动时间时间")]),t._v(" "),a("li",[t._v("节点创建时间")])]),t._v(" "),a("h3",{attrs:{id:"_2-2-客户端订阅的topic的列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-客户端订阅的topic的列表"}},[t._v("#")]),t._v(" 2.2 客户端订阅的Topic的列表")]),t._v(" "),a("ul",[a("li",[t._v("客户端ClientID")]),t._v(" "),a("li",[t._v("订阅 Topic")]),t._v(" "),a("li",[t._v("订阅的 Topic QoS")]),t._v(" "),a("li",[t._v("连接的 Broker 地址")])]),t._v(" "),a("h3",{attrs:{id:"_2-3-客户端与broker的连接配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-客户端与broker的连接配置"}},[t._v("#")]),t._v(" 2.3 客户端与Broker的连接配置")]),t._v(" "),a("ul",[a("li",[t._v("客户端ClientID")]),t._v(" "),a("li",[t._v("连接认证信息")]),t._v(" "),a("li",[t._v("当前连接状态")]),t._v(" "),a("li",[t._v("连接的 Broker 地址")]),t._v(" "),a("li",[t._v("客户端地址")]),t._v(" "),a("li",[t._v("心跳间隔")]),t._v(" "),a("li",[t._v("最近一次建立连接的时间")])]),t._v(" "),a("h3",{attrs:{id:"_2-4-运行指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-运行指标"}},[t._v("#")]),t._v(" 2.4 运行指标")]),t._v(" "),a("h3",{attrs:{id:"_2-5-chatgpt账户管理及日志"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-chatgpt账户管理及日志"}},[t._v("#")]),t._v(" 2.5 ChatGPT账户管理及日志")]),t._v(" "),a("ul",[a("li",[t._v("客户端账户")]),t._v(" "),a("li",[t._v("ChatGPT 分配的资源总额度")]),t._v(" "),a("li",[t._v("已消耗的额度")]),t._v(" "),a("li",[t._v("与ChatGPT 的对话日志")])]),t._v(" "),a("h2",{attrs:{id:"配置示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置示例"}},[t._v("#")]),t._v(" 配置示例")]),t._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("plugins")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("database")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# h2_mem、h2、mysql")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("dbType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" h2\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("blockquote",[a("p",[t._v("若未显式指定持久化模式，将默认选择："),a("strong",[t._v("h2_mem")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);